<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—á–∏–º —Å–ª–æ–≥–∏</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const Shuffle = () => (
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M16 3h5v5M4 20L21 3M21 16v5h-5M15 15l6 6M4 4l5 5"/>
            </svg>
        );

        const Filter = () => (
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>
            </svg>
        );

        const RussianSyllablesApp = () => {
          const consonants = ['–±', '–≤', '–≥', '–¥', '–∂', '–∑', '–∫', '–ª', '–º', '–Ω', '–ø', '—Ä', '—Å', '—Ç', '—Ñ', '—Ö', '—Ü', '—á', '—à', '—â'];
          const vowels = ['–∞', '–æ', '—É', '—ã', '—ç', '—è', '—ë', '—é', '–∏', '–µ'];
          
          // –°–ø–∏—Å–æ–∫ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Å–ª–æ–≥–æ–≤ –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ (–Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∞–±–ª–∏—Ü—ã)
          const invalidSyllables = [
            // –ñ: –Ω–µ —Å–æ—á–µ—Ç–∞–µ—Ç—Å—è —Å –´, –Ø, –Æ, –≠
            '–∂—ã', '–∂—è', '–∂—é', '–∂—ç',
            // –®: –Ω–µ —Å–æ—á–µ—Ç–∞–µ—Ç—Å—è —Å –´, –Ø, –Å, –Æ, –≠
            '—à—ã', '—à—è', '—à—ë', '—à—é', '—à—ç',
            // –ß: –Ω–µ —Å–æ—á–µ—Ç–∞–µ—Ç—Å—è —Å –´, –Ø, –Æ, –≠
            '—á—ã', '—á—è', '—á—é', '—á—ç',
            // –©: –Ω–µ —Å–æ—á–µ—Ç–∞–µ—Ç—Å—è —Å –´, –Ø, –Æ, –≠
            '—â—ã', '—â—è', '—â—é', '—â—ç',
            // –¶: –Ω–µ —Å–æ—á–µ—Ç–∞–µ—Ç—Å—è —Å –Ø, –Å, –Æ, –≠
            '—Ü—è', '—Ü—ë', '—Ü—é', '—Ü—ç'
          ];

          // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Å–ª–æ–≥–∞
          const isValidSyllable = (consonant, vowel) => {
            return !invalidSyllables.includes(consonant + vowel);
          };
          
          const backgrounds = [
            { name: '–ë–µ–ª—ã–π', value: 'bg-white', text: 'text-gray-800' },
            { name: '–ß–µ—Ä–Ω—ã–π', value: 'bg-gray-900', text: 'text-white' },
            { name: '–°–µ—Ä—ã–π', value: 'bg-gray-100', text: 'text-gray-800' },
            { name: '–ë–µ–∂–µ–≤—ã–π', value: 'bg-amber-50', text: 'text-gray-800' },
            { name: '–°–∏–Ω–∏–π', value: 'bg-blue-50', text: 'text-gray-800' }
          ];
          
          const [mode, setMode] = useState('random');
          const [selectedConsonant, setSelectedConsonant] = useState('');
          const [currentSyllable, setCurrentSyllable] = useState('');
          const [count, setCount] = useState(0);
          const [animate, setAnimate] = useState(false);
          const [showMenu, setShowMenu] = useState(true);
          const [soundEnabled, setSoundEnabled] = useState(false);
          const [bgIndex, setBgIndex] = useState(0);
          const [isUpperCase, setIsUpperCase] = useState(true);
          const [syllableOrder, setSyllableOrder] = useState('cv'); // 'cv' = consonant-vowel, 'vc' = vowel-consonant

          const generateRandomSyllable = () => {
            let consonant, vowel;
            do {
              consonant = consonants[Math.floor(Math.random() * consonants.length)];
              vowel = vowels[Math.floor(Math.random() * vowels.length)];
            } while (syllableOrder === 'cv' && !isValidSyllable(consonant, vowel));
            return syllableOrder === 'cv' ? consonant + vowel : vowel + consonant;
          };

          const generateSyllableWithConsonant = (consonant) => {
            let vowel;
            if (syllableOrder === 'cv') {
              const validVowels = vowels.filter(v => isValidSyllable(consonant, v));
              vowel = validVowels[Math.floor(Math.random() * validVowels.length)];
              return consonant + vowel;
            } else {
              // For VC mode, no validation needed - all combinations are valid
              vowel = vowels[Math.floor(Math.random() * vowels.length)];
              return vowel + consonant;
            }
          };

          const speakSyllable = (syllable) => {
            if (soundEnabled && 'speechSynthesis' in window) {
              const utterance = new SpeechSynthesisUtterance(syllable);
              utterance.lang = 'ru-RU';
              utterance.rate = 0.7;
              utterance.pitch = 1.2;
              window.speechSynthesis.cancel();
              window.speechSynthesis.speak(utterance);
            }
          };

          const nextSyllable = () => {
            // –°–Ω–∞—á–∞–ª–∞ –æ–∑–≤—É—á–∏–≤–∞–µ–º –¢–ï–ö–£–©–ò–ô —Å–ª–æ–≥ (–µ—Å–ª–∏ –∑–≤—É–∫ –≤–∫–ª—é—á–µ–Ω)
            if (soundEnabled && 'speechSynthesis' in window && currentSyllable) {
              const utterance = new SpeechSynthesisUtterance(currentSyllable);
              utterance.lang = 'ru-RU';
              utterance.rate = 0.7;
              utterance.pitch = 1.2;
              window.speechSynthesis.cancel();
              
              // –ü–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–æ–≤—ã–π —Å–ª–æ–≥
              utterance.onend = () => {
                showNextSyllable();
              };
              
              window.speechSynthesis.speak(utterance);
            } else {
              // –ï—Å–ª–∏ –∑–≤—É–∫ –≤—ã–∫–ª—é—á–µ–Ω, —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–æ–≤—ã–π —Å–ª–æ–≥
              showNextSyllable();
            }
          };

          const showNextSyllable = () => {
            setAnimate(true);
            setTimeout(() => {
              let newSyllable;
              // Keep generating until we get a different syllable
              do {
                newSyllable = mode === 'random'
                  ? generateRandomSyllable()
                  : generateSyllableWithConsonant(selectedConsonant);
              } while (newSyllable === currentSyllable);

              setCurrentSyllable(newSyllable);
              setCount(prev => prev + 1);
              setAnimate(false);
            }, 150);
          };

          const startMode = (newMode, consonant = '') => {
            setMode(newMode);
            setSelectedConsonant(consonant);
            setCount(0);
            setShowMenu(false);
            const firstSyllable = newMode === 'random' 
              ? generateRandomSyllable() 
              : generateSyllableWithConsonant(consonant);
            setCurrentSyllable(firstSyllable);
            // –ü–µ—Ä–≤—ã–π —Å–ª–æ–≥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ë–ï–ó –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è
          };

          useEffect(() => {
            const handleKeyPress = (e) => {
              if (e.code === 'Space' && !showMenu) {
                e.preventDefault();
                nextSyllable();
              }
              if (e.code === 'Escape' && !showMenu) {
                setShowMenu(true);
              }
            };
            window.addEventListener('keydown', handleKeyPress);
            return () => window.removeEventListener('keydown', handleKeyPress);
          }, [showMenu, mode, selectedConsonant, soundEnabled, isUpperCase, currentSyllable, syllableOrder]);

          if (showMenu) {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-400 via-pink-400 to-yellow-400 flex items-center justify-center p-4">
                <div className="bg-white rounded-3xl shadow-2xl p-8 max-w-4xl w-full">
                  <h1 className="text-5xl font-bold text-center mb-8 text-purple-600">
                    –£—á–∏–º —Å–ª–æ–≥–∏! üìö
                  </h1>

                  <div className="mb-6 flex justify-center gap-4">
                    <button
                      onClick={() => setSyllableOrder('cv')}
                      className={`px-8 py-4 rounded-xl text-2xl font-bold transition-all transform hover:scale-105 ${
                        syllableOrder === 'cv'
                          ? 'bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg'
                          : 'bg-gray-200 text-gray-600 hover:bg-gray-300'
                      }`}
                    >
                      –°–æ–≥–ª–∞—Å–Ω–∞—è + –ì–ª–∞—Å–Ω–∞—è<br/>
                      <span className="text-3xl">–ë–ê</span>
                    </button>
                    <button
                      onClick={() => setSyllableOrder('vc')}
                      className={`px-8 py-4 rounded-xl text-2xl font-bold transition-all transform hover:scale-105 ${
                        syllableOrder === 'vc'
                          ? 'bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg'
                          : 'bg-gray-200 text-gray-600 hover:bg-gray-300'
                      }`}
                    >
                      –ì–ª–∞—Å–Ω–∞—è + –°–æ–≥–ª–∞—Å–Ω–∞—è<br/>
                      <span className="text-3xl">–ê–ë</span>
                    </button>
                  </div>

                  <div className="mb-8">
                    <button
                      onClick={() => startMode('random')}
                      className="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-2xl p-8 text-3xl font-bold hover:shadow-xl transition-all transform hover:scale-105 flex items-center justify-center gap-4"
                    >
                      <Shuffle />
                      –°–ª—É—á–∞–π–Ω—ã–µ —Å–ª–æ–≥–∏
                    </button>
                  </div>

                  <div className="mb-4">
                    <h2 className="text-2xl font-bold text-gray-700 mb-4 flex items-center gap-2">
                      <Filter />
                      –í—ã–±–µ—Ä–∏ –±—É–∫–≤—É:
                    </h2>
                    <div className="grid grid-cols-5 gap-3">
                      {consonants.map(consonant => (
                        <button
                          key={consonant}
                          onClick={() => startMode('selected', consonant)}
                          className="bg-gradient-to-br from-green-400 to-blue-500 text-white rounded-xl p-1 text-3xl font-bold hover:shadow-lg transition-all transform hover:scale-110 flex flex-col items-center justify-center gap-1"
                        >
                          <span>{consonant.toUpperCase()}</span>
                          <span className="text-2xl">{consonant}</span>
                        </button>
                      ))}
                    </div>
                  </div>

                  <div className="mt-6 text-center text-gray-600 text-lg">
                    üí° –ù–∞–∂–∏–º–∞–π <kbd className="px-3 py-1 bg-gray-200 rounded">–ü—Ä–æ–±–µ–ª</kbd> –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–ª–æ–≥–∞
                  </div>
                </div>
              </div>
            );
          }

          return (
            <div
              className={`min-h-screen ${backgrounds[bgIndex].value} flex flex-col items-center justify-center cursor-pointer transition-colors duration-300 overflow-hidden`}
              onClick={nextSyllable}
            >
              <div
                className="absolute top-2 right-2 md:top-6 md:right-6 flex gap-2 md:gap-4 flex-wrap justify-end"
                onClick={(e) => e.stopPropagation()}
              >
                <div className={`bg-opacity-80 ${backgrounds[bgIndex].value === 'bg-gray-900' ? 'bg-white text-gray-900' : 'bg-gray-900 text-white'} rounded-full px-3 py-2 md:px-6 md:py-3 shadow-lg text-lg md:text-2xl font-bold`}>
                  {count}
                </div>
                <button
                  onClick={(e) => {
                    e.stopPropagation();
                    setIsUpperCase(!isUpperCase);
                  }}
                  className={`rounded-full px-3 py-2 md:px-6 md:py-3 shadow-lg text-base md:text-xl font-bold transition ${
                    backgrounds[bgIndex].value === 'bg-gray-900' ? 'bg-white text-gray-700 hover:bg-gray-100' : 'bg-gray-900 text-white hover:bg-gray-800'
                  }`}
                  title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä"
                >
                  {isUpperCase ? '–ê–ë' : '–∞–±'}
                </button>
                <button
                  onClick={(e) => {
                    e.stopPropagation();
                    setSoundEnabled(!soundEnabled);
                  }}
                  className={`rounded-full px-3 py-2 md:px-6 md:py-3 shadow-lg text-base md:text-xl font-bold transition ${
                    soundEnabled 
                      ? 'bg-green-500 text-white' 
                      : backgrounds[bgIndex].value === 'bg-gray-900' ? 'bg-white text-gray-700' : 'bg-gray-900 text-white'
                  }`}
                  title={soundEnabled ? '–í—ã–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫' : '–í–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫'}
                >
                  {soundEnabled ? 'üîä' : 'üîá'}
                </button>
                <button
                  onClick={(e) => {
                    e.stopPropagation();
                    setBgIndex((bgIndex + 1) % backgrounds.length);
                  }}
                  className={`rounded-full px-3 py-2 md:px-6 md:py-3 shadow-lg text-base md:text-xl font-bold transition ${
                    backgrounds[bgIndex].value === 'bg-gray-900' ? 'bg-white text-gray-700 hover:bg-gray-100' : 'bg-gray-900 text-white hover:bg-gray-800'
                  }`}
                  title="–°–º–µ–Ω–∏—Ç—å —Ñ–æ–Ω"
                >
                  üé®
                </button>
                <button
                  onClick={(e) => {
                    e.stopPropagation();
                    setShowMenu(true);
                  }}
                  className={`rounded-full px-3 py-2 md:px-6 md:py-3 shadow-lg text-base md:text-xl font-bold transition ${
                    backgrounds[bgIndex].value === 'bg-gray-900' ? 'bg-white text-gray-700 hover:bg-gray-100' : 'bg-gray-900 text-white hover:bg-gray-800'
                  }`}
                  title="–ú–µ–Ω—é"
                >
                  ‚ò∞
                </button>
              </div>

              {mode === 'selected' && (
                <div
                  className={`absolute top-2 left-2 md:top-6 md:left-6 rounded-full px-3 py-2 md:px-6 md:py-3 shadow-lg ${
                    backgrounds[bgIndex].value === 'bg-gray-900' ? 'bg-white' : 'bg-gray-900'
                  }`}
                  onClick={(e) => e.stopPropagation()}
                >
                  <span className={`text-lg md:text-2xl font-bold ${
                    backgrounds[bgIndex].value === 'bg-gray-900' ? 'text-gray-900' : 'text-white'
                  }`}>
                    {selectedConsonant.toUpperCase()} {selectedConsonant}
                  </span>
                </div>
              )}

              <div
                className={`transition-all duration-150 ${animate ? 'scale-75 opacity-0' : 'scale-100 opacity-100'} w-full flex justify-center pointer-events-none`}
              >
                <div
                  className={`font-bold ${backgrounds[bgIndex].text} select-none leading-none`}
                  style={{ fontSize: '45vw' }}
                >
                  {syllableOrder === 'cv' ? (
                    <>
                      <span className={backgrounds[bgIndex].value === 'bg-gray-900' ? 'text-blue-400' : 'text-blue-600'}>
                        {isUpperCase ? currentSyllable[0].toUpperCase() : currentSyllable[0]}
                      </span>
                      <span className={backgrounds[bgIndex].value === 'bg-gray-900' ? 'text-red-400' : 'text-red-600'}>
                        {isUpperCase ? currentSyllable[1].toUpperCase() : currentSyllable[1]}
                      </span>
                    </>
                  ) : (
                    <>
                      <span className={backgrounds[bgIndex].value === 'bg-gray-900' ? 'text-red-400' : 'text-red-600'}>
                        {isUpperCase ? currentSyllable[0].toUpperCase() : currentSyllable[0]}
                      </span>
                      <span className={backgrounds[bgIndex].value === 'bg-gray-900' ? 'text-blue-400' : 'text-blue-600'}>
                        {isUpperCase ? currentSyllable[1].toUpperCase() : currentSyllable[1]}
                      </span>
                    </>
                  )}
                </div>
              </div>

              <div
                className={`absolute bottom-4 md:bottom-8 text-sm md:text-xl font-semibold rounded-full px-4 py-2 md:px-8 md:py-4 ${
                  backgrounds[bgIndex].value === 'bg-gray-900' ? 'bg-white text-gray-900' : 'bg-gray-900 text-white'
                } bg-opacity-80`}
                onClick={(e) => e.stopPropagation()}
              >
                –ù–∞–∂–º–∏ –ü–†–û–ë–ï–õ –∏–ª–∏ —ç–∫—Ä–∞–Ω –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–ª–æ–≥–∞
              </div>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<RussianSyllablesApp />);
    </script>
</body>
</html>
